track_features <- track_features %>% mutate(generic_genre = as.factor((genres == 'metal')+ 2*(genres == 'rock')))
levels(track_features$generic_genre) <- c('otro','metal','rock')
ggplot(track_features %>% distinct(track.id,energy, acousticness, generic_genre), aes(energy, acousticness, color = generic_genre)) + geom_point() + theme_bw()
ggplot(track_features %>% distinct(track.id,danceability, speechiness,generic_genre),aes(danceability, speechiness, color = generic_genre)) + geom_point() + theme_bw()
ggplot(track_features %>% distinct(track.id, danceability, generic_genre),aes(danceability, group = generic_genre, color = generic_genre)) + geom_density() + theme_bw()
energy_d <- ggplot(track_features %>% distinct(track.id,energy, generic_genre), aes(energy, group = generic_genre,color = generic_genre)) + geom_density() + theme_bw()
tempo_d <- ggplot(track_features %>% distinct(track.id,tempo, generic_genre), aes(tempo, group = generic_genre,color = generic_genre)) + geom_density() + theme_bw()
instru_d <- ggplot(track_features %>% distinct(track.id,instrumentalness,generic_genre),aes(instrumentalness,group = generic_genre, color = generic_genre)) + geom_density() + theme_bw()
loud_d <- ggplot(track_features %>% distinct(track.id,loudness,generic_genre),aes(loudness,group = generic_genre,color=generic_genre)) + geom_density() + theme_bw()
energy_d + tempo_d + instru_d + loud_d
ggplot(
track_features %>%
select(track.id, genres) %>%
filter(genres %in% c("rock", "metal")) %>%
mutate(is = TRUE) %>%
pivot_wider(names_from = genres, values_from = is, values_fill = FALSE) %>%
mutate(value = paste(rock, metal)),
aes(value)) +
scale_x_discrete(labels = c("rock", "metal", "ambas")) + # cambiar texto x
xlab("") + # quitar etiqueta x
geom_bar() +
geom_text(stat='count', aes(label=..count..), vjust=-0.5) + # poner num
theme_bw()
set.seed(1)
r <- track_features %>% filter(genres %in% c('rock')) %>% slice_sample(n=50)
track_part <- track_features %>% filter(genres %!in% c('rock','metal')) %>% rbind(r)
count_genre <-  ggplot(track_part, aes(genres)) + geom_bar() + theme_bw() + geom_text(stat = 'count', aes(label = ..count.., vjust = -0.2))
corr_features <- ggcorr(track_part %>% select(-c('track.id','genres')))
count_genre + corr_features
dance_box <- ggplot(track_part %>% distinct(track.id,danceability,genres), aes(danceability,group = genres, color = genres)) + geom_boxplot() +theme_bw()
loud_box <- ggplot(track_part %>% distinct(track.id,loudness,genres), aes(loudness,group = genres, color = genres)) + geom_boxplot() +theme_bw()
acoustic_box <- ggplot(track_part %>% distinct(track.id,acousticness,genres), aes(acousticness,group = genres, color = genres)) + geom_boxplot() +theme_bw()
tempo_box <- ggplot(track_part %>% distinct(track.id,tempo,genres), aes(tempo,group = genres, color = genres)) + geom_boxplot() +theme_bw()
dance_box + loud_box + acoustic_box + tempo_box
ggplot(
track_part %>%
select(track.id, genres) %>%
filter(genres %in% c("edm", "house")) %>%
mutate(is = TRUE) %>%
pivot_wider(names_from = genres, values_from = is, values_fill = FALSE) %>%
mutate(value = paste(edm, house)),
aes(value)) +
scale_x_discrete(labels = c("edm", "house", "ambas")) + # cambiar texto x
xlab("") + # quitar etiqueta x
geom_bar() +
geom_text(stat='count', aes(label=..count..), vjust=-0.5) + # poner num
theme_bw()
track_part_final <- track_part %>% filter(genres %!in% c("house"))
#GUARDO LA PARTICION FINAL
save(track_part_final, file = "track_part_final.RData")
den1 <- ggplot(track_part_final) + geom_density(aes(loudness), color = 'green') + geom_density(aes(speechiness), color = 'orange') + geom_density(aes(liveness), color = 'purple') + geom_density(aes(tempo), color = 'darkslateblue') + xlab('feature')
den2 <- ggplot(track_part_final) + geom_density(aes(instrumentalness), color = 'cyan') + geom_density(aes(valence), color = 'chocolate') + geom_density(aes(acousticness),color = 'pink') + geom_density(aes(danceability), color = 'darkmagenta') + geom_density(aes(energy), color = 'red') + xlab('feature')
den1+den2
load('key_mode.RData')
track_part_final <- track_part_final %>% left_join(key_mode)
track_part_final <- track_part_final %>% mutate(mode = as.factor(mode))
levels(track_part_final$mode) <- c("Menor", "Mayor")
ggplot(track_part_final %>%
distinct(track.id, key, mode), aes(as.factor(key), fill = factor(mode))) +
geom_bar(position = "dodge") +
labs(x = "Key", fill = "Mode") + scale_fill_brewer(palette = "Dark2") +
# hay más paletas aquí https://r-graph-gallery.com/38-rcolorbrewers-palettes.html
scale_x_discrete(labels = c("Do",
"Do#/Reb",
"Re",
"Re#/Mib",
"Mi",
"Fa",
"Fa#/Solb",
"Sol",
"Sol#/Lab",
"La",
"La#/Sib",
"Si")) +
theme_bw()
track_part_final <- track_part_final %>% left_join(key_mode, by = c("track.id","genres"))
track_part_final <- track_part_final %>% mutate(key = key/11)
track_part_final <- track_part_final %>% select(-c("key.x","key.y","mode.x","mode.y"))
track_part_final <- track_part_final %>% left_join(key_mode, by = c("track.id","genres"))
track_part_final <- track_part_final %>% mutate(key = key/11)
save(track_part_final, file = "track_part_final.RData")
source('01_setup.R')
load('track_features.RData')
load('tracks_genre_features.RData')
CH <- track_part_final %>% select(-c("track.id","genres")) %>% NbClust(method = "kmeans",index = "ch")
track_part_final <- track_part_final %>% select(-c("generic_genre"))
CH <- track_part_final %>% select(-c("track.id","genres")) %>% NbClust(method = "kmeans",index = "ch")
S <- track_part_final %>% select(-c("track.id","genres")) %>% NbClust(method = "kmeans",index = "silhouette")
S
CH
CH <- track_part_final %>% select(-c("track.id","genres")) %>% NbClust(method = "kmeans",index = "ch")
S <- track_part_final %>% select(-c("track.id","genres")) %>% NbClust(method = "kmeans",index = "silhouette")
CH_graph <- c()
k <- c(2:10)
for (i in 2:8) {
CH_value <- track_part_final %>% select(-c("track.id","genres")) %>% NbClust(min.nc = i, max.nc = i, method = "kmeans", index = "ch")
CH_graph <- cbind(CH_graph,CH_value$Best.nc)
}
ggplot(tibble(CH_graph,k),aes(k,CH_graph))
tibble(CH_graph,k)
k
CH_graph
CH <- track_part_final %>% select(-c("track.id","genres")) %>% NbClust(method = "kmeans",index = "ch")
S <- track_part_final %>% select(-c("track.id","genres")) %>% NbClust(method = "kmeans",index = "silhouette")
CH_graph <- c()
k <- c(2:10)
for (i in 2:8) {
CH_value <- track_part_final %>% select(-c("track.id","genres")) %>% NbClust(min.nc = i, max.nc = i, method = "kmeans", index = "ch")
CH_graph <- cbind(CH_graph,CH_value$Best.nc)
}
ggplot(CH_graph,aes(Number_clusters,Value_Index))
tibble(CH_graph)
tibble(CH_graph'')
tibble(t(CH_graph))
unnest(CH_graph)
unnest(t(CH_graph)
unnest(t(CH_graph))
unnest(t(CH_graph))
data.frame(CH_graph)
data.frame(t(CH_graph)
data.frame(t(CH_graph))
data.frame(t(CH_graph))
ggplot(data.frame(t(CH_graph)),aes(Number_clusters,Value_Index))
ggplot(data.frame(t(CH_graph)),aes(Number_clusters,Value_Index))+geom_dotplot()
ggplot(data.frame(t(CH_graph)),aes(Number_clusters,Value_Index))+geom_point()
ggplot(data.frame(t(CH_graph)),aes(Number_clusters,Value_Index))+geom_point(color = 'blue')+geom_line(color = 'red')
CH <- track_part_final %>% select(-c("track.id","genres")) %>% NbClust(method = "kmeans",index = "ch")
S <- track_part_final %>% select(-c("track.id","genres")) %>% NbClust(method = "kmeans",index = "silhouette")
CH_graph <- c()
k <- c(2:10)
for (i in 2:length(k)) {
CH_value <- track_part_final %>% select(-c("track.id","genres")) %>% NbClust(min.nc = i, max.nc = i, method = "kmeans", index = "ch")
CH_graph <- cbind(CH_graph,CH_value$Best.nc)
}
CH_plot <- ggplot(data.frame(t(CH_graph)),aes(Number_clusters,Value_Index))+geom_point(color = 'blue')+geom_line(color = 'red')
CH <- track_part_final %>% select(-c("track.id","genres")) %>% NbClust(method = "kmeans",index = "ch")
S <- track_part_final %>% select(-c("track.id","genres")) %>% NbClust(method = "kmeans",index = "silhouette")
CH_graph <- c()
k <- c(2:10)
for (i in 2:length(k)) {
CH_value <- track_part_final %>% select(-c("track.id","genres")) %>% NbClust(min.nc = i, max.nc = i, method = "kmeans", index = "ch")
CH_graph <- cbind(CH_graph,CH_value$Best.nc)
}
CH_plot <- ggplot(data.frame(t(CH_graph)),aes(Number_clusters,Value_Index))+geom_point(color = 'blue')+geom_line(color = 'red')
S_graph <- c()
for (i in 2:length(k)) {
S_value <- track_part_final %>% select(-c("track.id","genres")) %>% NbClust(min.nc = i, max.nc = i, method = "kmeans", index = "silhouette")
S_graph <- cbind(S_graph,S_value$Best.nc)
}
S_plot <- ggplot(data.frame(t(S_graph)),aes(Number_clusters,Value_Index))+geom_point(color = 'blue')+geom_line(color = 'red')
CH_plot+S_plot
CH <- track_part_final %>% select(-c("track.id","genres")) %>% NbClust(method = "kmeans",index = "ch")
S <- track_part_final %>% select(-c("track.id","genres")) %>% NbClust(method = "kmeans",index = "silhouette")
CH_graph <- c()
k <- c(2:10)
for (i in 2:length(k)) {
CH_value <- track_part_final %>% select(-c("track.id","genres")) %>% NbClust(min.nc = i, max.nc = i, method = "kmeans", index = "ch")
CH_graph <- cbind(CH_graph,CH_value$Best.nc)
}
CH_plot <- ggplot(data.frame(t(CH_graph)),aes(Number_clusters,Value_Index))+geom_point(color = 'blue')+geom_line(color = 'red')
S_graph <- c()
for (i in 2:length(k)) {
S_value <- track_part_final %>% select(-c("track.id","genres")) %>% NbClust(min.nc = i, max.nc = i, method = "kmeans", index = "silhouette")
S_graph <- cbind(S_graph,S_value$Best.nc)
}
S_plot <- ggplot(data.frame(t(S_graph)),aes(Number_clusters,Value_Index))+geom_point(color = 'blue')+geom_line(color = 'red')
N_graph <- c()
for (i in 2:length(k)) {
N_value <- track_part_final %>% select(-c("track.id","genres")) %>% NbClust(min.nc = i, max.nc = i, method = "kmeans")
N_graph <- cbind(N_graph,Nvalue$Best.nc)
}
N_graph <- c()
for (i in 2:length(k)) {
N_value <- track_part_final %>% select(-c("track.id","genres")) %>% NbClust(min.nc = i, max.nc = i+1, method = "kmeans")
N_graph <- cbind(N_graph,Nvalue$Best.nc)
}
for (i in 2:length(k)) {
N_value <- track_part_final %>% select(-c("track.id","genres")) %>% NbClust(min.nc = i, max.nc = i+2, method = "kmeans")
N_graph <- cbind(N_graph,Nvalue$Best.nc)
}
for (i in 2:length(k)) {
N_value <- track_part_final %>% select(-c("track.id","genres")) %>% NbClust(min.nc = i, max.nc = i+2, method = "kmeans")
N_graph <- cbind(N_graph,N_value$Best.nc)
}
N_plot <- ggplot(data.frame(t(N_graph)),aes(Number_clusters,Value_Index))+geom_point(color = 'blue')+geom_line(color = 'red')
CH_plot+S_plot+N_plot
N <- track_part_final %>% select(-c("track.id","genres")) %>% NbClust(method = "kmeans")
CH_plot+S_plot
CH <- track_part_final %>% select(-c("track.id","genres")) %>% NbClust(method = "kmeans",index = "ch")
S <- track_part_final %>% select(-c("track.id","genres")) %>% NbClust(method = "kmeans",index = "silhouette")
CH_graph <- c()
k <- c(2:10)
for (i in 2:length(k)) {
CH_value <- track_part_final %>% select(-c("track.id","genres")) %>% NbClust(min.nc = i, max.nc = i, method = "complete", index = "ch")
CH_graph <- cbind(CH_graph,CH_value$Best.nc)
}
CH_plot <- ggplot(data.frame(t(CH_graph)),aes(Number_clusters,Value_Index))+geom_point(color = 'blue')+geom_line(color = 'red')
S_graph <- c()
for (i in 2:length(k)) {
S_value <- track_part_final %>% select(-c("track.id","genres")) %>% NbClust(min.nc = i, max.nc = i, method = "complete", index = "silhouette")
S_graph <- cbind(S_graph,S_value$Best.nc)
}
S_plot <- ggplot(data.frame(t(S_graph)),aes(Number_clusters,Value_Index))+geom_point(color = 'blue')+geom_line(color = 'red')
N <- track_part_final %>% select(-c("track.id","genres")) %>% NbClust(method = "complete")
CH_plot+S_plot
CH <- track_part_final %>% select(-c("track.id","genres")) %>% NbClust(method = "kmeans",index = "ch")
S <- track_part_final %>% select(-c("track.id","genres")) %>% NbClust(method = "kmeans",index = "silhouette")
CH_graph <- c()
k <- c(2:10)
for (i in 2:length(k)) {
CH_value <- track_part_final %>% select(-c("track.id","genres")) %>% NbClust(min.nc = i, max.nc = i, method = "single", index = "ch")
CH_graph <- cbind(CH_graph,CH_value$Best.nc)
}
CH_plot <- ggplot(data.frame(t(CH_graph)),aes(Number_clusters,Value_Index))+geom_point(color = 'blue')+geom_line(color = 'red')
S_graph <- c()
for (i in 2:length(k)) {
S_value <- track_part_final %>% select(-c("track.id","genres")) %>% NbClust(min.nc = i, max.nc = i, method = "single", index = "silhouette")
S_graph <- cbind(S_graph,S_value$Best.nc)
}
S_plot <- ggplot(data.frame(t(S_graph)),aes(Number_clusters,Value_Index))+geom_point(color = 'blue')+geom_line(color = 'red')
CH_plot+S_plot
?NbClust
CH_value$Best.nc
CH_value$Best.nc[2]
#hago el numero de clusters para 3 metodos: kmeans, single, complete
CH_graph <- c()
k <- c(2:10)
for (i in 2:length(k)) {
CH_single <- track_part_final %>% select(-c("track.id","genres")) %>% NbClust(min.nc = i, max.nc = i, method = "single", index = "ch")
CH_complete <- track_part_final %>% select(-c("track.id","genres")) %>% NbClust(min.nc = i, max.nc = i, method = "complete", index = "ch")
CH_kmeans <- track_part_final %>% select(-c("track.id","genres")) %>% NbClust(min.nc = i, max.nc = i, method = "kmeans", index = "ch")
CH_graph <- cbind(CH_graph,CH_kmeans$Best.nc,CH_single$Best.nc[2],CH_complete$Best.nc[2])
}
CH_plot <- ggplot(data.frame(t(CH_graph)),aes(Number_clusters,Value_Index))+geom_point(color = 'blue')+geom_line(color = 'red')
CH_plot
CH_graph
names(CH_single)
names(CH_single$Best.nc)
?rownames
#hago el numero de clusters para 3 metodos: kmeans, single, complete
CH_graph <- c()
k <- c(2:10)
for (i in 2:length(k)) {
CH_single <- track_part_final %>% select(-c("track.id","genres")) %>% NbClust(min.nc = i, max.nc = i, method = "single", index = "ch")
CH_single <- CH_single$Best.nc %>% row.names(c("Number_Clusters","Index_Single"))
CH_complete <- track_part_final %>% select(-c("track.id","genres")) %>% NbClust(min.nc = i, max.nc = i, method = "complete", index = "ch")
CH_complete <- CH_single$Best.nc %>% row.names(c("Number_Clusters","Index_Complete"))
CH_kmeans <- track_part_final %>% select(-c("track.id","genres")) %>% NbClust(min.nc = i, max.nc = i, method = "kmeans", index = "ch")
CH_kmeans <- CH_single$Best.nc %>% row.names(c("Number_Clusters","Index_Kmeans"))
CH_graph <- cbind(CH_graph,CH_kmeans$Best.nc,CH_single$Best.nc[2],CH_complete$Best.nc[2])
}
for (i in 2:length(k)) {
CH_single <- track_part_final %>% select(-c("track.id","genres")) %>% NbClust(min.nc = i, max.nc = i, method = "single", index = "ch")
CH_complete <- track_part_final %>% select(-c("track.id","genres")) %>% NbClust(min.nc = i, max.nc = i, method = "complete", index = "ch")
CH_kmeans <- track_part_final %>% select(-c("track.id","genres")) %>% NbClust(min.nc = i, max.nc = i, method = "kmeans", index = "ch")
CH_graph <- cbind(CH_graph,CH_kmeans$Best.nc,CH_single$Best.nc,CH_complete$Best.nc)
}
CH_graph
for (i in 2:length(k)) {
CH_single <- track_part_final %>% select(-c("track.id","genres")) %>% NbClust(min.nc = i, max.nc = i, method = "single", index = "ch")
CH_complete <- track_part_final %>% select(-c("track.id","genres")) %>% NbClust(min.nc = i, max.nc = i, method = "complete", index = "ch")
CH_kmeans <- track_part_final %>% select(-c("track.id","genres")) %>% NbClust(min.nc = i, max.nc = i, method = "kmeans", index = "ch")
aux <- rbind(CH_kmeans$Best.nc,CH_single$Best.nc,CH_complete$Best.nc)
CH_graph <- cbind(CH_graph,aux)
}
#hago el numero de clusters para 3 metodos: kmeans, single, complete
CH_graph <- c()
k <- c(2:10)
for (i in 2:length(k)) {
CH_single <- track_part_final %>% select(-c("track.id","genres")) %>% NbClust(min.nc = i, max.nc = i, method = "single", index = "ch")
CH_complete <- track_part_final %>% select(-c("track.id","genres")) %>% NbClust(min.nc = i, max.nc = i, method = "complete", index = "ch")
CH_kmeans <- track_part_final %>% select(-c("track.id","genres")) %>% NbClust(min.nc = i, max.nc = i, method = "kmeans", index = "ch")
aux <- rbind(CH_kmeans$Best.nc,CH_single$Best.nc,CH_complete$Best.nc)
CH_graph <- cbind(CH_graph,aux)
}
CH_graph
data.frame(t(CH_graph)
data.frame(t(CH_graph)
data.frame(t(CH_graph))
CH_single
CH_single$Best.nc
row_names(CH_single$Best.nc,c("Number_clusters","single"))
row.names(CH_single$Best.nc,c("Number_clusters","single"))
head(CH_single$Best.nc)
row.names(CH_single$Best.nc,"single")
row.names(head(CH_single$Best.nc),"Number_clusters single")
t(CH_single)
t(CH_single$Best.nc)
?rename
rename(CH_single,c("Value_Index" = "Single"))
rename(CH_single$Best.nc,c("Value_Index" = "Single"))
colnames(CH_single$Best.nc)
colnames(t(CH_single$Best.nc)
colnames(t(CH_single$Best.nc))
?colnames
colnames(t(CH_single$Best.nc),c("Number_Clusters","Single"))
colnames(t(CH_single$Best.nc)) <- c("Number_Clusters","Single")
colnames(t(CH_single$Best.nc)) <- c("Number_Clusters","Single")
colnames(t(CH_single$Best.nc))
colnames(t(CH_single$Best.nc)) <- c("Number_Clusters","Single")
CH_single <- track_part_final %>% select(-c("track.id","genres")) %>% NbClust(min.nc = i, max.nc = i, method = "single", index = "ch")
CH_single <- t(CH_single$Best.nc)
colnames(CH_single) <- c("Number_Clusters","Single")
CH_single
for (i in 2:length(k)) {
CH_single <- track_part_final %>% select(-c("track.id","genres")) %>% NbClust(min.nc = i, max.nc = i, method = "single", index = "ch")
CH_single <- t(CH_single$Best.nc)
colnames(CH_single) <- c("Number_Clusters","Single")
CH_complete <- track_part_final %>% select(-c("track.id","genres")) %>% NbClust(min.nc = i, max.nc = i, method = "complete", index = "ch")
CH_complete <- t(CH_complete$Best.nc)
colnames(CH_complete) <- c("Number_Clusters","Single")
CH_kmeans <- track_part_final %>% select(-c("track.id","genres")) %>% NbClust(min.nc = i, max.nc = i, method = "kmeans", index = "ch")
CH_Kmeans <- t(CH_KmeansBest.nc)
colnames(CH_single) <- c("Number_Clusters","K means")
aux <- rbind(CH_kmeans,CH_single,CH_complete)
CH_graph <- cbind(CH_graph,aux)
}
#hago el numero de clusters para 3 metodos: kmeans, single, complete
CH_graph <- c()
k <- c(2:10)
for (i in 2:length(k)) {
CH_single <- track_part_final %>% select(-c("track.id","genres")) %>% NbClust(min.nc = i, max.nc = i, method = "single", index = "ch")
CH_single <- t(CH_single$Best.nc)
colnames(CH_single) <- c("Number_Clusters","Single")
CH_complete <- track_part_final %>% select(-c("track.id","genres")) %>% NbClust(min.nc = i, max.nc = i, method = "complete", index = "ch")
CH_complete <- t(CH_complete$Best.nc)
colnames(CH_complete) <- c("Number_Clusters","Single")
CH_kmeans <- track_part_final %>% select(-c("track.id","genres")) %>% NbClust(min.nc = i, max.nc = i, method = "kmeans", index = "ch")
CH_Kmeans <- t(CH_KmeansBest.nc)
colnames(CH_single) <- c("Number_Clusters","K means")
aux <- rbind(CH_kmeans,CH_single,CH_complete)
CH_graph <- cbind(CH_graph,aux)
}
#hago el numero de clusters para 3 metodos: kmeans, single, complete
CH_graph <- c()
k <- c(2:10)
for (i in 2:length(k)) {
CH_single <- track_part_final %>% select(-c("track.id","genres")) %>% NbClust(min.nc = i, max.nc = i, method = "single", index = "ch")
CH_single <- t(CH_single$Best.nc)
colnames(CH_single) <- c("Number_Clusters","Single")
CH_complete <- track_part_final %>% select(-c("track.id","genres")) %>% NbClust(min.nc = i, max.nc = i, method = "complete", index = "ch")
CH_complete <- t(CH_complete$Best.nc)
colnames(CH_complete) <- c("Number_Clusters","Single")
CH_kmeans <- track_part_final %>% select(-c("track.id","genres")) %>% NbClust(min.nc = i, max.nc = i, method = "kmeans", index = "ch")
CH_Kmeans <- t(CH_Kmeans$Best.nc)
colnames(CH_single) <- c("Number_Clusters","K means")
aux <- rbind(CH_kmeans,CH_single,CH_complete)
CH_graph <- cbind(CH_graph,aux)
}
#hago el numero de clusters para 3 metodos: kmeans, single, complete
CH_graph <- c()
k <- c(2:10)
for (i in 2:length(k)) {
CH_single <- track_part_final %>% select(-c("track.id","genres")) %>% NbClust(min.nc = i, max.nc = i, method = "single", index = "ch")
CH_single <- t(CH_single$Best.nc)
colnames(CH_single) <- c("Number_Clusters","Single")
CH_complete <- track_part_final %>% select(-c("track.id","genres")) %>% NbClust(min.nc = i, max.nc = i, method = "complete", index = "ch")
CH_complete <- t(CH_complete$Best.nc)
colnames(CH_complete) <- c("Number_Clusters","Single")
CH_kmeans <- track_part_final %>% select(-c("track.id","genres")) %>% NbClust(min.nc = i, max.nc = i, method = "kmeans", index = "ch")
CH_kmeans <- t(CH_kmeans$Best.nc)
colnames(CH_kmeans) <- c("Number_Clusters","K means")
aux <- rbind(CH_kmeans,CH_single,CH_complete)
CH_graph <- cbind(CH_graph,aux)
}
CH_graph
aux
CH_kmeans
#hago el numero de clusters para 3 metodos: kmeans, single, complete
CH_graph <- c()
k <- c(2:10)
for (i in 2:length(k)) {
CH_single <- track_part_final %>% select(-c("track.id","genres")) %>% NbClust(min.nc = i, max.nc = i, method = "single", index = "ch")
CH_single <- t(CH_single$Best.nc)
colnames(CH_single) <- c("Number_Clusters","Single")
CH_complete <- track_part_final %>% select(-c("track.id","genres")) %>% NbClust(min.nc = i, max.nc = i, method = "complete", index = "ch")
CH_complete <- t(CH_complete$Best.nc)
colnames(CH_complete) <- c("Number_Clusters","Single")
CH_kmeans <- track_part_final %>% select(-c("track.id","genres")) %>% NbClust(min.nc = i, max.nc = i, method = "kmeans", index = "ch")
CH_kmeans <- t(CH_kmeans$Best.nc)
colnames(CH_kmeans) <- c("Number_Clusters","K means")
aux <- cbind(CH_kmeans,CH_single[2],CH_complete[2])
CH_graph <- rbind(CH_graph,aux)
}
CH_graph
colnames(CH_graph)
CH_plot <- ggplot(data.frame(CH_graph))+geom_point(aes(Number_Clusters,K means),color = 'blue')+geom_line(color = 'blue')
CH_plot <- ggplot(data.frame(CH_graph),aes(Number_Clusters))+geom_point(aes(Single),color = 'blue')+geom_line(color = 'blue')
CH_plot
CH_gepah
CH_graph
colnames(CH_graph) <- c("Number_Clusters","K means","Single","Complete")
CH_graph
CH_plot <- ggplot(data.frame(CH_graph),aes(Number_Clusters,Kmeans,))+geom_point(aes(Single),color = 'blue')+geom_line(color = 'blue')
CH_plot
colnames(CH_graph) <- c("Number_Clusters","K-means","Single","Complete")
CH_plot <- ggplot(data.frame(CH_graph)) + geom_point(aes(Number_Clusters,K-means),color = 'blue') + geom_line(aes(Number_Clusters,K-means),color = 'blue')
CH_plot
data.frame(CH_graph)
CH_graph <- data.frame(CH_graph)
CH_plot <- ggplot(CH_graph) + geom_point(aes(Number_Clusters,K-means),color = 'blue') + geom_line(aes(Number_Clusters,K-means),color = 'blue')
CH_plot
?geom_point
CH_plot <- ggplot(CH_graph) + geom_point(mapping = aes(Number_Clusters,K-means),color = 'blue') + geom_line(aes(Number_Clusters,K-means),color = 'blue')
CH_plot
CH_graph$K.means
CH_plot <- ggplot(CH_graph) + geom_point(mapping = aes(x = Number_Clusters,y = K.means),color = 'blue') + geom_line(aes(Number_Clusters,K.means),color = 'blue')
CH_plot
CH_plot <- ggplot(CH_graph) + geom_point(mapping = aes(x = Number_Clusters,y = K.means),color = 'blue') + geom_line(aes(Number_Clusters,K.means),color = 'blue')
CH_plot
CH_plot <- ggplot(CH_graph) + geom_point(mapping = aes(Number_Clusters,K.means),color = 'blue') + geom_line(aes(Number_Clusters,K.means),color = 'blue')
CH_plot
CH_plot <- ggplot(CH_graph) + geom_point(mapping = aes(Number_Clusters,K.means)) + geom_line(aes(Number_Clusters,K.means))
CH_plot
colnames(CH_graph) <- c("Number_Clusters","K.means","Single","Complete")
CH_graph <- data.frame(CH_graph)
CH_plot <- ggplot(CH_graph) + geom_point(mapping = aes(Number_Clusters,K.means)) + geom_line(aes(Number_Clusters,K.means))
CH_plot
CH_plot
CH_plot <- ggplot(CH_graph) + geom_point(mapping = aes(Number_Clusters,K.means),color = 'cyan',size = 3) + geom_line(aes(Number_Clusters,K.means),color = 'blue')
CH_plot
CH_plot <- ggplot(CH_graph) + geom_point(mapping = aes(Number_Clusters,K.means),color = 'cyan',size = 3) + geom_line(aes(Number_Clusters,K.means),color = 'blue') +
geom_point(mapping = aes(Number_Clusters,Single),color = 'darkred',size = 3) + geom_line(aes(Number_Clusters,Single),color = 'red') +
geom_point(mapping = aes(Number_Clusters,Complete),color = 'yellow',size = 3) + geom_line(aes(Number_Clusters,Complete),color = 'green')
CH_plot
CH_plot <- ggplot(CH_graph) + geom_point(mapping = aes(Number_Clusters,K.means),color = 'cyan',size = 3) + geom_line(aes(Number_Clusters,K.means),color = 'blue') +
geom_point(mapping = aes(Number_Clusters,Single),color = 'darkred',size = 3) + geom_line(aes(Number_Clusters,Single),color = 'red') +
geom_point(mapping = aes(Number_Clusters,Complete),color = 'forest',size = 3) + geom_line(aes(Number_Clusters,Complete),color = 'green')
CH_plot
CH_plot <- ggplot(CH_graph) + geom_point(mapping = aes(Number_Clusters,K.means),color = 'darkblue',size = 3) + geom_line(aes(Number_Clusters,K.means),color = 'cyan') +
geom_point(mapping = aes(Number_Clusters,Single),color = 'darkred',size = 3) + geom_line(aes(Number_Clusters,Single),color = 'red') +
geom_point(mapping = aes(Number_Clusters,Complete),color = 'darkgreen',size = 3) + geom_line(aes(Number_Clusters,Complete),color = 'green')
CH_plot
CH_plot
#hago el numero de clusters para 3 metodos: kmeans, single, complete
CH_graph <- c()
k <- c(2:10)
for (i in 2:length(k)) {
CH_single <- track_part_final %>% select(-c("track.id","genres")) %>% NbClust(min.nc = i, max.nc = i, method = "single", index = "ch")
CH_single <- t(CH_single$Best.nc)
colnames(CH_single) <- c("Number_Clusters","Single")
CH_complete <- track_part_final %>% select(-c("track.id","genres")) %>% NbClust(min.nc = i, max.nc = i, method = "complete", index = "ch")
CH_complete <- t(CH_complete$Best.nc)
colnames(CH_complete) <- c("Number_Clusters","Complete")
CH_kmeans <- track_part_final %>% select(-c("track.id","genres")) %>% NbClust(min.nc = i, max.nc = i, method = "kmeans", index = "ch")
CH_kmeans <- t(CH_kmeans$Best.nc)
colnames(CH_kmeans) <- c("Number_Clusters","K means")
aux <- cbind(CH_kmeans,CH_single[2],CH_complete[2])
CH_graph <- rbind(CH_graph,aux)
}
colnames(CH_graph) <- c("Number_Clusters","K.means","Single","Complete")
CH_graph <- data.frame(CH_graph)
CH_plot <- ggplot(CH_graph) + geom_point(mapping = aes(Number_Clusters,K.means),color = 'darkblue',size = 3) + geom_line(aes(Number_Clusters,K.means),color = 'cyan') +
geom_point(mapping = aes(Number_Clusters,Single),color = 'darkred',size = 3) + geom_line(aes(Number_Clusters,Single),color = 'red') +
geom_point(mapping = aes(Number_Clusters,Complete),color = 'darkgreen',size = 3) + geom_line(aes(Number_Clusters,Complete),color = 'green')
S_graph <- c()
for (i in 2:length(k)) {
S_single <- track_part_final %>% select(-c("track.id","genres")) %>% NbClust(min.nc = i, max.nc = i, method = "single", index = "silhouette")
S_single <- t(S_single$Best.nc)
colnames(SH_single) <- c("Number_Clusters","Single")
S_complete <- track_part_final %>% select(-c("track.id","genres")) %>% NbClust(min.nc = i, max.nc = i, method = "complete", index = "silhouette")
S_complete <- t(S_complete$Best.nc)
colnames(S_complete) <- c("Number_Clusters","Complete")
S_kmeans <- track_part_final %>% select(-c("track.id","genres")) %>% NbClust(min.nc = i, max.nc = i, method = "kmeans", index = "silhouette")
S_kmeans <- t(S_kmeans$Best.nc)
colnames(S_kmeans) <- c("Number_Clusters","K means")
aux <- cbind(S_kmeans,S_single[2],S_complete[2])
S_graph <- rbind(S_graph,aux)
colnames(S_graph) <- c("Number_Clusters","K means","Single","Complete")
}
#hago el numero de clusters para 3 metodos: kmeans, single, complete
CH_graph <- c()
k <- c(2:10)
for (i in 2:length(k)) {
CH_single <- track_part_final %>% select(-c("track.id","genres")) %>% NbClust(min.nc = i, max.nc = i, method = "single", index = "ch")
CH_single <- t(CH_single$Best.nc)
colnames(CH_single) <- c("Number_Clusters","Single")
CH_complete <- track_part_final %>% select(-c("track.id","genres")) %>% NbClust(min.nc = i, max.nc = i, method = "complete", index = "ch")
CH_complete <- t(CH_complete$Best.nc)
colnames(CH_complete) <- c("Number_Clusters","Complete")
CH_kmeans <- track_part_final %>% select(-c("track.id","genres")) %>% NbClust(min.nc = i, max.nc = i, method = "kmeans", index = "ch")
CH_kmeans <- t(CH_kmeans$Best.nc)
colnames(CH_kmeans) <- c("Number_Clusters","K means")
aux <- cbind(CH_kmeans,CH_single[2],CH_complete[2])
CH_graph <- rbind(CH_graph,aux)
}
colnames(CH_graph) <- c("Number_Clusters","K.means","Single","Complete")
CH_graph <- data.frame(CH_graph)
CH_plot <- ggplot(CH_graph) + geom_point(mapping = aes(Number_Clusters,K.means),color = 'darkblue',size = 3) + geom_line(aes(Number_Clusters,K.means),color = 'cyan') +
geom_point(mapping = aes(Number_Clusters,Single),color = 'darkred',size = 3) + geom_line(aes(Number_Clusters,Single),color = 'red') +
geom_point(mapping = aes(Number_Clusters,Complete),color = 'darkgreen',size = 3) + geom_line(aes(Number_Clusters,Complete),color = 'green')
S_graph <- c()
for (i in 2:length(k)) {
S_single <- track_part_final %>% select(-c("track.id","genres")) %>% NbClust(min.nc = i, max.nc = i, method = "single", index = "silhouette")
S_single <- t(S_single$Best.nc)
colnames(S_single) <- c("Number_Clusters","Single")
S_complete <- track_part_final %>% select(-c("track.id","genres")) %>% NbClust(min.nc = i, max.nc = i, method = "complete", index = "silhouette")
S_complete <- t(S_complete$Best.nc)
colnames(S_complete) <- c("Number_Clusters","Complete")
S_kmeans <- track_part_final %>% select(-c("track.id","genres")) %>% NbClust(min.nc = i, max.nc = i, method = "kmeans", index = "silhouette")
S_kmeans <- t(S_kmeans$Best.nc)
colnames(S_kmeans) <- c("Number_Clusters","K means")
aux <- cbind(S_kmeans,S_single[2],S_complete[2])
S_graph <- rbind(S_graph,aux)
colnames(S_graph) <- c("Number_Clusters","K means","Single","Complete")
}
colnames(S_graph) <- c("Number_Clusters","K.means","Single","Complete")
S_graph <- data.frame(S_graph)
S_plot <- ggplot(S_graph) + geom_point(mapping = aes(Number_Clusters,K.means),color = 'darkblue',size = 3) + geom_line(aes(Number_Clusters,K.means),color = 'cyan') +
geom_point(mapping = aes(Number_Clusters,Single),color = 'darkred',size = 3) + geom_line(aes(Number_Clusters,Single),color = 'red') +
geom_point(mapping = aes(Number_Clusters,Complete),color = 'darkgreen',size = 3) + geom_line(aes(Number_Clusters,Complete),color = 'green')
CH_plot+S_plot
