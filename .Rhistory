}
S_plot <- ggplot(data.frame(t(S_graph)),aes(Number_clusters,Value_Index))+geom_point(color = 'blue')+geom_line(color = 'red')
CH_plot+S_plot
?NbClust
CH_value$Best.nc
CH_value$Best.nc[2]
#hago el numero de clusters para 3 metodos: kmeans, single, complete
CH_graph <- c()
k <- c(2:10)
for (i in 2:length(k)) {
CH_single <- track_part_final %>% select(-c("track.id","genres")) %>% NbClust(min.nc = i, max.nc = i, method = "single", index = "ch")
CH_complete <- track_part_final %>% select(-c("track.id","genres")) %>% NbClust(min.nc = i, max.nc = i, method = "complete", index = "ch")
CH_kmeans <- track_part_final %>% select(-c("track.id","genres")) %>% NbClust(min.nc = i, max.nc = i, method = "kmeans", index = "ch")
CH_graph <- cbind(CH_graph,CH_kmeans$Best.nc,CH_single$Best.nc[2],CH_complete$Best.nc[2])
}
CH_plot <- ggplot(data.frame(t(CH_graph)),aes(Number_clusters,Value_Index))+geom_point(color = 'blue')+geom_line(color = 'red')
CH_plot
CH_graph
names(CH_single)
names(CH_single$Best.nc)
?rownames
#hago el numero de clusters para 3 metodos: kmeans, single, complete
CH_graph <- c()
k <- c(2:10)
for (i in 2:length(k)) {
CH_single <- track_part_final %>% select(-c("track.id","genres")) %>% NbClust(min.nc = i, max.nc = i, method = "single", index = "ch")
CH_single <- CH_single$Best.nc %>% row.names(c("Number_Clusters","Index_Single"))
CH_complete <- track_part_final %>% select(-c("track.id","genres")) %>% NbClust(min.nc = i, max.nc = i, method = "complete", index = "ch")
CH_complete <- CH_single$Best.nc %>% row.names(c("Number_Clusters","Index_Complete"))
CH_kmeans <- track_part_final %>% select(-c("track.id","genres")) %>% NbClust(min.nc = i, max.nc = i, method = "kmeans", index = "ch")
CH_kmeans <- CH_single$Best.nc %>% row.names(c("Number_Clusters","Index_Kmeans"))
CH_graph <- cbind(CH_graph,CH_kmeans$Best.nc,CH_single$Best.nc[2],CH_complete$Best.nc[2])
}
for (i in 2:length(k)) {
CH_single <- track_part_final %>% select(-c("track.id","genres")) %>% NbClust(min.nc = i, max.nc = i, method = "single", index = "ch")
CH_complete <- track_part_final %>% select(-c("track.id","genres")) %>% NbClust(min.nc = i, max.nc = i, method = "complete", index = "ch")
CH_kmeans <- track_part_final %>% select(-c("track.id","genres")) %>% NbClust(min.nc = i, max.nc = i, method = "kmeans", index = "ch")
CH_graph <- cbind(CH_graph,CH_kmeans$Best.nc,CH_single$Best.nc,CH_complete$Best.nc)
}
CH_graph
for (i in 2:length(k)) {
CH_single <- track_part_final %>% select(-c("track.id","genres")) %>% NbClust(min.nc = i, max.nc = i, method = "single", index = "ch")
CH_complete <- track_part_final %>% select(-c("track.id","genres")) %>% NbClust(min.nc = i, max.nc = i, method = "complete", index = "ch")
CH_kmeans <- track_part_final %>% select(-c("track.id","genres")) %>% NbClust(min.nc = i, max.nc = i, method = "kmeans", index = "ch")
aux <- rbind(CH_kmeans$Best.nc,CH_single$Best.nc,CH_complete$Best.nc)
CH_graph <- cbind(CH_graph,aux)
}
#hago el numero de clusters para 3 metodos: kmeans, single, complete
CH_graph <- c()
k <- c(2:10)
for (i in 2:length(k)) {
CH_single <- track_part_final %>% select(-c("track.id","genres")) %>% NbClust(min.nc = i, max.nc = i, method = "single", index = "ch")
CH_complete <- track_part_final %>% select(-c("track.id","genres")) %>% NbClust(min.nc = i, max.nc = i, method = "complete", index = "ch")
CH_kmeans <- track_part_final %>% select(-c("track.id","genres")) %>% NbClust(min.nc = i, max.nc = i, method = "kmeans", index = "ch")
aux <- rbind(CH_kmeans$Best.nc,CH_single$Best.nc,CH_complete$Best.nc)
CH_graph <- cbind(CH_graph,aux)
}
CH_graph
data.frame(t(CH_graph)
data.frame(t(CH_graph)
data.frame(t(CH_graph))
CH_single
CH_single$Best.nc
row_names(CH_single$Best.nc,c("Number_clusters","single"))
row.names(CH_single$Best.nc,c("Number_clusters","single"))
head(CH_single$Best.nc)
row.names(CH_single$Best.nc,"single")
row.names(head(CH_single$Best.nc),"Number_clusters single")
t(CH_single)
t(CH_single$Best.nc)
?rename
rename(CH_single,c("Value_Index" = "Single"))
rename(CH_single$Best.nc,c("Value_Index" = "Single"))
colnames(CH_single$Best.nc)
colnames(t(CH_single$Best.nc)
colnames(t(CH_single$Best.nc))
?colnames
colnames(t(CH_single$Best.nc),c("Number_Clusters","Single"))
colnames(t(CH_single$Best.nc)) <- c("Number_Clusters","Single")
colnames(t(CH_single$Best.nc)) <- c("Number_Clusters","Single")
colnames(t(CH_single$Best.nc))
colnames(t(CH_single$Best.nc)) <- c("Number_Clusters","Single")
CH_single <- track_part_final %>% select(-c("track.id","genres")) %>% NbClust(min.nc = i, max.nc = i, method = "single", index = "ch")
CH_single <- t(CH_single$Best.nc)
colnames(CH_single) <- c("Number_Clusters","Single")
CH_single
for (i in 2:length(k)) {
CH_single <- track_part_final %>% select(-c("track.id","genres")) %>% NbClust(min.nc = i, max.nc = i, method = "single", index = "ch")
CH_single <- t(CH_single$Best.nc)
colnames(CH_single) <- c("Number_Clusters","Single")
CH_complete <- track_part_final %>% select(-c("track.id","genres")) %>% NbClust(min.nc = i, max.nc = i, method = "complete", index = "ch")
CH_complete <- t(CH_complete$Best.nc)
colnames(CH_complete) <- c("Number_Clusters","Single")
CH_kmeans <- track_part_final %>% select(-c("track.id","genres")) %>% NbClust(min.nc = i, max.nc = i, method = "kmeans", index = "ch")
CH_Kmeans <- t(CH_KmeansBest.nc)
colnames(CH_single) <- c("Number_Clusters","K means")
aux <- rbind(CH_kmeans,CH_single,CH_complete)
CH_graph <- cbind(CH_graph,aux)
}
#hago el numero de clusters para 3 metodos: kmeans, single, complete
CH_graph <- c()
k <- c(2:10)
for (i in 2:length(k)) {
CH_single <- track_part_final %>% select(-c("track.id","genres")) %>% NbClust(min.nc = i, max.nc = i, method = "single", index = "ch")
CH_single <- t(CH_single$Best.nc)
colnames(CH_single) <- c("Number_Clusters","Single")
CH_complete <- track_part_final %>% select(-c("track.id","genres")) %>% NbClust(min.nc = i, max.nc = i, method = "complete", index = "ch")
CH_complete <- t(CH_complete$Best.nc)
colnames(CH_complete) <- c("Number_Clusters","Single")
CH_kmeans <- track_part_final %>% select(-c("track.id","genres")) %>% NbClust(min.nc = i, max.nc = i, method = "kmeans", index = "ch")
CH_Kmeans <- t(CH_KmeansBest.nc)
colnames(CH_single) <- c("Number_Clusters","K means")
aux <- rbind(CH_kmeans,CH_single,CH_complete)
CH_graph <- cbind(CH_graph,aux)
}
#hago el numero de clusters para 3 metodos: kmeans, single, complete
CH_graph <- c()
k <- c(2:10)
for (i in 2:length(k)) {
CH_single <- track_part_final %>% select(-c("track.id","genres")) %>% NbClust(min.nc = i, max.nc = i, method = "single", index = "ch")
CH_single <- t(CH_single$Best.nc)
colnames(CH_single) <- c("Number_Clusters","Single")
CH_complete <- track_part_final %>% select(-c("track.id","genres")) %>% NbClust(min.nc = i, max.nc = i, method = "complete", index = "ch")
CH_complete <- t(CH_complete$Best.nc)
colnames(CH_complete) <- c("Number_Clusters","Single")
CH_kmeans <- track_part_final %>% select(-c("track.id","genres")) %>% NbClust(min.nc = i, max.nc = i, method = "kmeans", index = "ch")
CH_Kmeans <- t(CH_Kmeans$Best.nc)
colnames(CH_single) <- c("Number_Clusters","K means")
aux <- rbind(CH_kmeans,CH_single,CH_complete)
CH_graph <- cbind(CH_graph,aux)
}
#hago el numero de clusters para 3 metodos: kmeans, single, complete
CH_graph <- c()
k <- c(2:10)
for (i in 2:length(k)) {
CH_single <- track_part_final %>% select(-c("track.id","genres")) %>% NbClust(min.nc = i, max.nc = i, method = "single", index = "ch")
CH_single <- t(CH_single$Best.nc)
colnames(CH_single) <- c("Number_Clusters","Single")
CH_complete <- track_part_final %>% select(-c("track.id","genres")) %>% NbClust(min.nc = i, max.nc = i, method = "complete", index = "ch")
CH_complete <- t(CH_complete$Best.nc)
colnames(CH_complete) <- c("Number_Clusters","Single")
CH_kmeans <- track_part_final %>% select(-c("track.id","genres")) %>% NbClust(min.nc = i, max.nc = i, method = "kmeans", index = "ch")
CH_kmeans <- t(CH_kmeans$Best.nc)
colnames(CH_kmeans) <- c("Number_Clusters","K means")
aux <- rbind(CH_kmeans,CH_single,CH_complete)
CH_graph <- cbind(CH_graph,aux)
}
CH_graph
aux
CH_kmeans
#hago el numero de clusters para 3 metodos: kmeans, single, complete
CH_graph <- c()
k <- c(2:10)
for (i in 2:length(k)) {
CH_single <- track_part_final %>% select(-c("track.id","genres")) %>% NbClust(min.nc = i, max.nc = i, method = "single", index = "ch")
CH_single <- t(CH_single$Best.nc)
colnames(CH_single) <- c("Number_Clusters","Single")
CH_complete <- track_part_final %>% select(-c("track.id","genres")) %>% NbClust(min.nc = i, max.nc = i, method = "complete", index = "ch")
CH_complete <- t(CH_complete$Best.nc)
colnames(CH_complete) <- c("Number_Clusters","Single")
CH_kmeans <- track_part_final %>% select(-c("track.id","genres")) %>% NbClust(min.nc = i, max.nc = i, method = "kmeans", index = "ch")
CH_kmeans <- t(CH_kmeans$Best.nc)
colnames(CH_kmeans) <- c("Number_Clusters","K means")
aux <- cbind(CH_kmeans,CH_single[2],CH_complete[2])
CH_graph <- rbind(CH_graph,aux)
}
CH_graph
colnames(CH_graph)
CH_plot <- ggplot(data.frame(CH_graph))+geom_point(aes(Number_Clusters,K means),color = 'blue')+geom_line(color = 'blue')
CH_plot <- ggplot(data.frame(CH_graph),aes(Number_Clusters))+geom_point(aes(Single),color = 'blue')+geom_line(color = 'blue')
CH_plot
CH_gepah
CH_graph
colnames(CH_graph) <- c("Number_Clusters","K means","Single","Complete")
CH_graph
CH_plot <- ggplot(data.frame(CH_graph),aes(Number_Clusters,Kmeans,))+geom_point(aes(Single),color = 'blue')+geom_line(color = 'blue')
CH_plot
colnames(CH_graph) <- c("Number_Clusters","K-means","Single","Complete")
CH_plot <- ggplot(data.frame(CH_graph)) + geom_point(aes(Number_Clusters,K-means),color = 'blue') + geom_line(aes(Number_Clusters,K-means),color = 'blue')
CH_plot
data.frame(CH_graph)
CH_graph <- data.frame(CH_graph)
CH_plot <- ggplot(CH_graph) + geom_point(aes(Number_Clusters,K-means),color = 'blue') + geom_line(aes(Number_Clusters,K-means),color = 'blue')
CH_plot
?geom_point
CH_plot <- ggplot(CH_graph) + geom_point(mapping = aes(Number_Clusters,K-means),color = 'blue') + geom_line(aes(Number_Clusters,K-means),color = 'blue')
CH_plot
CH_graph$K.means
CH_plot <- ggplot(CH_graph) + geom_point(mapping = aes(x = Number_Clusters,y = K.means),color = 'blue') + geom_line(aes(Number_Clusters,K.means),color = 'blue')
CH_plot
CH_plot <- ggplot(CH_graph) + geom_point(mapping = aes(x = Number_Clusters,y = K.means),color = 'blue') + geom_line(aes(Number_Clusters,K.means),color = 'blue')
CH_plot
CH_plot <- ggplot(CH_graph) + geom_point(mapping = aes(Number_Clusters,K.means),color = 'blue') + geom_line(aes(Number_Clusters,K.means),color = 'blue')
CH_plot
CH_plot <- ggplot(CH_graph) + geom_point(mapping = aes(Number_Clusters,K.means)) + geom_line(aes(Number_Clusters,K.means))
CH_plot
colnames(CH_graph) <- c("Number_Clusters","K.means","Single","Complete")
CH_graph <- data.frame(CH_graph)
CH_plot <- ggplot(CH_graph) + geom_point(mapping = aes(Number_Clusters,K.means)) + geom_line(aes(Number_Clusters,K.means))
CH_plot
CH_plot
CH_plot <- ggplot(CH_graph) + geom_point(mapping = aes(Number_Clusters,K.means),color = 'cyan',size = 3) + geom_line(aes(Number_Clusters,K.means),color = 'blue')
CH_plot
CH_plot <- ggplot(CH_graph) + geom_point(mapping = aes(Number_Clusters,K.means),color = 'cyan',size = 3) + geom_line(aes(Number_Clusters,K.means),color = 'blue') +
geom_point(mapping = aes(Number_Clusters,Single),color = 'darkred',size = 3) + geom_line(aes(Number_Clusters,Single),color = 'red') +
geom_point(mapping = aes(Number_Clusters,Complete),color = 'yellow',size = 3) + geom_line(aes(Number_Clusters,Complete),color = 'green')
CH_plot
CH_plot <- ggplot(CH_graph) + geom_point(mapping = aes(Number_Clusters,K.means),color = 'cyan',size = 3) + geom_line(aes(Number_Clusters,K.means),color = 'blue') +
geom_point(mapping = aes(Number_Clusters,Single),color = 'darkred',size = 3) + geom_line(aes(Number_Clusters,Single),color = 'red') +
geom_point(mapping = aes(Number_Clusters,Complete),color = 'forest',size = 3) + geom_line(aes(Number_Clusters,Complete),color = 'green')
CH_plot
CH_plot <- ggplot(CH_graph) + geom_point(mapping = aes(Number_Clusters,K.means),color = 'darkblue',size = 3) + geom_line(aes(Number_Clusters,K.means),color = 'cyan') +
geom_point(mapping = aes(Number_Clusters,Single),color = 'darkred',size = 3) + geom_line(aes(Number_Clusters,Single),color = 'red') +
geom_point(mapping = aes(Number_Clusters,Complete),color = 'darkgreen',size = 3) + geom_line(aes(Number_Clusters,Complete),color = 'green')
CH_plot
CH_plot
#hago el numero de clusters para 3 metodos: kmeans, single, complete
CH_graph <- c()
k <- c(2:10)
for (i in 2:length(k)) {
CH_single <- track_part_final %>% select(-c("track.id","genres")) %>% NbClust(min.nc = i, max.nc = i, method = "single", index = "ch")
CH_single <- t(CH_single$Best.nc)
colnames(CH_single) <- c("Number_Clusters","Single")
CH_complete <- track_part_final %>% select(-c("track.id","genres")) %>% NbClust(min.nc = i, max.nc = i, method = "complete", index = "ch")
CH_complete <- t(CH_complete$Best.nc)
colnames(CH_complete) <- c("Number_Clusters","Complete")
CH_kmeans <- track_part_final %>% select(-c("track.id","genres")) %>% NbClust(min.nc = i, max.nc = i, method = "kmeans", index = "ch")
CH_kmeans <- t(CH_kmeans$Best.nc)
colnames(CH_kmeans) <- c("Number_Clusters","K means")
aux <- cbind(CH_kmeans,CH_single[2],CH_complete[2])
CH_graph <- rbind(CH_graph,aux)
}
colnames(CH_graph) <- c("Number_Clusters","K.means","Single","Complete")
CH_graph <- data.frame(CH_graph)
CH_plot <- ggplot(CH_graph) + geom_point(mapping = aes(Number_Clusters,K.means),color = 'darkblue',size = 3) + geom_line(aes(Number_Clusters,K.means),color = 'cyan') +
geom_point(mapping = aes(Number_Clusters,Single),color = 'darkred',size = 3) + geom_line(aes(Number_Clusters,Single),color = 'red') +
geom_point(mapping = aes(Number_Clusters,Complete),color = 'darkgreen',size = 3) + geom_line(aes(Number_Clusters,Complete),color = 'green')
S_graph <- c()
for (i in 2:length(k)) {
S_single <- track_part_final %>% select(-c("track.id","genres")) %>% NbClust(min.nc = i, max.nc = i, method = "single", index = "silhouette")
S_single <- t(S_single$Best.nc)
colnames(SH_single) <- c("Number_Clusters","Single")
S_complete <- track_part_final %>% select(-c("track.id","genres")) %>% NbClust(min.nc = i, max.nc = i, method = "complete", index = "silhouette")
S_complete <- t(S_complete$Best.nc)
colnames(S_complete) <- c("Number_Clusters","Complete")
S_kmeans <- track_part_final %>% select(-c("track.id","genres")) %>% NbClust(min.nc = i, max.nc = i, method = "kmeans", index = "silhouette")
S_kmeans <- t(S_kmeans$Best.nc)
colnames(S_kmeans) <- c("Number_Clusters","K means")
aux <- cbind(S_kmeans,S_single[2],S_complete[2])
S_graph <- rbind(S_graph,aux)
colnames(S_graph) <- c("Number_Clusters","K means","Single","Complete")
}
#hago el numero de clusters para 3 metodos: kmeans, single, complete
CH_graph <- c()
k <- c(2:10)
for (i in 2:length(k)) {
CH_single <- track_part_final %>% select(-c("track.id","genres")) %>% NbClust(min.nc = i, max.nc = i, method = "single", index = "ch")
CH_single <- t(CH_single$Best.nc)
colnames(CH_single) <- c("Number_Clusters","Single")
CH_complete <- track_part_final %>% select(-c("track.id","genres")) %>% NbClust(min.nc = i, max.nc = i, method = "complete", index = "ch")
CH_complete <- t(CH_complete$Best.nc)
colnames(CH_complete) <- c("Number_Clusters","Complete")
CH_kmeans <- track_part_final %>% select(-c("track.id","genres")) %>% NbClust(min.nc = i, max.nc = i, method = "kmeans", index = "ch")
CH_kmeans <- t(CH_kmeans$Best.nc)
colnames(CH_kmeans) <- c("Number_Clusters","K means")
aux <- cbind(CH_kmeans,CH_single[2],CH_complete[2])
CH_graph <- rbind(CH_graph,aux)
}
colnames(CH_graph) <- c("Number_Clusters","K.means","Single","Complete")
CH_graph <- data.frame(CH_graph)
CH_plot <- ggplot(CH_graph) + geom_point(mapping = aes(Number_Clusters,K.means),color = 'darkblue',size = 3) + geom_line(aes(Number_Clusters,K.means),color = 'cyan') +
geom_point(mapping = aes(Number_Clusters,Single),color = 'darkred',size = 3) + geom_line(aes(Number_Clusters,Single),color = 'red') +
geom_point(mapping = aes(Number_Clusters,Complete),color = 'darkgreen',size = 3) + geom_line(aes(Number_Clusters,Complete),color = 'green')
S_graph <- c()
for (i in 2:length(k)) {
S_single <- track_part_final %>% select(-c("track.id","genres")) %>% NbClust(min.nc = i, max.nc = i, method = "single", index = "silhouette")
S_single <- t(S_single$Best.nc)
colnames(S_single) <- c("Number_Clusters","Single")
S_complete <- track_part_final %>% select(-c("track.id","genres")) %>% NbClust(min.nc = i, max.nc = i, method = "complete", index = "silhouette")
S_complete <- t(S_complete$Best.nc)
colnames(S_complete) <- c("Number_Clusters","Complete")
S_kmeans <- track_part_final %>% select(-c("track.id","genres")) %>% NbClust(min.nc = i, max.nc = i, method = "kmeans", index = "silhouette")
S_kmeans <- t(S_kmeans$Best.nc)
colnames(S_kmeans) <- c("Number_Clusters","K means")
aux <- cbind(S_kmeans,S_single[2],S_complete[2])
S_graph <- rbind(S_graph,aux)
colnames(S_graph) <- c("Number_Clusters","K means","Single","Complete")
}
colnames(S_graph) <- c("Number_Clusters","K.means","Single","Complete")
S_graph <- data.frame(S_graph)
S_plot <- ggplot(S_graph) + geom_point(mapping = aes(Number_Clusters,K.means),color = 'darkblue',size = 3) + geom_line(aes(Number_Clusters,K.means),color = 'cyan') +
geom_point(mapping = aes(Number_Clusters,Single),color = 'darkred',size = 3) + geom_line(aes(Number_Clusters,Single),color = 'red') +
geom_point(mapping = aes(Number_Clusters,Complete),color = 'darkgreen',size = 3) + geom_line(aes(Number_Clusters,Complete),color = 'green')
CH_plot+S_plot
source('01_setup.R')
load('track_features.RData')
load('tracks_genre_features.RData')
track_part_final <- track_part_final %>% mutate(fifths = (1-mode)*key + mode*((key+3/11) %% 1))
#hago el numero de clusters para 3 metodos: kmeans, single, complete
CH_graph <- c()
k <- c(2:10)
for (i in 2:length(k)) {
CH_single <- track_part_final %>% select(-c("track.id","genres")) %>% NbClust(min.nc = i, max.nc = i, method = "single", index = "ch")
CH_single <- t(CH_single$Best.nc)
colnames(CH_single) <- c("Number_Clusters","Single")
CH_complete <- track_part_final %>% select(-c("track.id","genres")) %>% NbClust(min.nc = i, max.nc = i, method = "complete", index = "ch")
CH_complete <- t(CH_complete$Best.nc)
colnames(CH_complete) <- c("Number_Clusters","Complete")
CH_kmeans <- track_part_final %>% select(-c("track.id","genres")) %>% NbClust(min.nc = i, max.nc = i, method = "kmeans", index = "ch")
CH_kmeans <- t(CH_kmeans$Best.nc)
colnames(CH_kmeans) <- c("Number_Clusters","K means")
aux <- cbind(CH_kmeans,CH_single[2],CH_complete[2])
CH_graph <- rbind(CH_graph,aux)
}
colnames(CH_graph) <- c("Number_Clusters","K.means","Single","Complete")
CH_graph <- data.frame(CH_graph)
CH_plot <- ggplot(CH_graph) + geom_point(mapping = aes(Number_Clusters,K.means),color = 'darkblue',size = 3) + geom_line(aes(Number_Clusters,K.means),color = 'cyan') +
geom_point(mapping = aes(Number_Clusters,Single),color = 'darkred',size = 3) + geom_line(aes(Number_Clusters,Single),color = 'red') +
geom_point(mapping = aes(Number_Clusters,Complete),color = 'darkgreen',size = 3) + geom_line(aes(Number_Clusters,Complete),color = 'green')
S_graph <- c()
for (i in 2:length(k)) {
S_single <- track_part_final %>% select(-c("track.id","genres")) %>% NbClust(min.nc = i, max.nc = i, method = "single", index = "silhouette")
S_single <- t(S_single$Best.nc)
colnames(S_single) <- c("Number_Clusters","Single")
S_complete <- track_part_final %>% select(-c("track.id","genres")) %>% NbClust(min.nc = i, max.nc = i, method = "complete", index = "silhouette")
S_complete <- t(S_complete$Best.nc)
colnames(S_complete) <- c("Number_Clusters","Complete")
S_kmeans <- track_part_final %>% select(-c("track.id","genres")) %>% NbClust(min.nc = i, max.nc = i, method = "kmeans", index = "silhouette")
S_kmeans <- t(S_kmeans$Best.nc)
colnames(S_kmeans) <- c("Number_Clusters","K means")
aux <- cbind(S_kmeans,S_single[2],S_complete[2])
S_graph <- rbind(S_graph,aux)
colnames(S_graph) <- c("Number_Clusters","K means","Single","Complete")
}
colnames(S_graph) <- c("Number_Clusters","K.means","Single","Complete")
S_graph <- data.frame(S_graph)
S_plot <- ggplot(S_graph) + geom_point(mapping = aes(Number_Clusters,K.means),color = 'darkblue',size = 3) + geom_line(aes(Number_Clusters,K.means),color = 'cyan') +
geom_point(mapping = aes(Number_Clusters,Single),color = 'darkred',size = 3) + geom_line(aes(Number_Clusters,Single),color = 'red') +
geom_point(mapping = aes(Number_Clusters,Complete),color = 'darkgreen',size = 3) + geom_line(aes(Number_Clusters,Complete),color = 'green')
CH_plot+S_plot
#hago el numero de clusters para 3 metodos: kmeans, single, complete
CH_graph <- c()
k <- c(2:10)
for (i in 2:length(k)) {
CH_single <- track_part_final %>% select(-c("track.id","genres")) %>% NbClust(min.nc = i, max.nc = i, method = "single", index = "ch")
CH_single <- t(CH_single$Best.nc)
colnames(CH_single) <- c("Number_Clusters","Single")
CH_complete <- track_part_final %>% select(-c("track.id","genres")) %>% NbClust(min.nc = i, max.nc = i, method = "complete", index = "ch")
CH_complete <- t(CH_complete$Best.nc)
colnames(CH_complete) <- c("Number_Clusters","Complete")
CH_kmeans <- track_part_final %>% select(-c("track.id","genres")) %>% NbClust(min.nc = i, max.nc = i, method = "kmeans", index = "ch")
CH_kmeans <- t(CH_kmeans$Best.nc)
colnames(CH_kmeans) <- c("Number_Clusters","K means")
aux <- cbind(CH_kmeans,CH_single[2],CH_complete[2])
CH_graph <- rbind(CH_graph,aux)
}
colnames(CH_graph) <- c("Number_Clusters","K.means","Single","Complete")
CH_graph <- data.frame(CH_graph)
CH_plot <- ggplot(CH_graph) + geom_point(mapping = aes(Number_Clusters,K.means),color = 'darkblue',size = 3) + geom_line(aes(Number_Clusters,K.means),color = 'cyan') +
geom_point(mapping = aes(Number_Clusters,Single),color = 'darkred',size = 3) + geom_line(aes(Number_Clusters,Single),color = 'red') +
geom_point(mapping = aes(Number_Clusters,Complete),color = 'darkgreen',size = 3) + geom_line(aes(Number_Clusters,Complete),color = 'green') + xlab('Número de Clusters') + ylab('Índice CH')
S_graph <- c()
for (i in 2:length(k)) {
S_single <- track_part_final %>% select(-c("track.id","genres")) %>% NbClust(min.nc = i, max.nc = i, method = "single", index = "silhouette")
S_single <- t(S_single$Best.nc)
colnames(S_single) <- c("Number_Clusters","Single")
S_complete <- track_part_final %>% select(-c("track.id","genres")) %>% NbClust(min.nc = i, max.nc = i, method = "complete", index = "silhouette")
S_complete <- t(S_complete$Best.nc)
colnames(S_complete) <- c("Number_Clusters","Complete")
S_kmeans <- track_part_final %>% select(-c("track.id","genres")) %>% NbClust(min.nc = i, max.nc = i, method = "kmeans", index = "silhouette")
S_kmeans <- t(S_kmeans$Best.nc)
colnames(S_kmeans) <- c("Number_Clusters","K means")
aux <- cbind(S_kmeans,S_single[2],S_complete[2])
S_graph <- rbind(S_graph,aux)
colnames(S_graph) <- c("Number_Clusters","K means","Single","Complete")
}
colnames(S_graph) <- c("Number_Clusters","K.means","Single","Complete")
S_graph <- data.frame(S_graph)
S_plot <- ggplot(S_graph) + geom_point(mapping = aes(Number_Clusters,K.means),color = 'darkblue',size = 3) + geom_line(aes(Number_Clusters,K.means),color = 'cyan') +
geom_point(mapping = aes(Number_Clusters,Single),color = 'darkred',size = 3) + geom_line(aes(Number_Clusters,Single),color = 'red') +
geom_point(mapping = aes(Number_Clusters,Complete),color = 'darkgreen',size = 3) + geom_line(aes(Number_Clusters,Complete),color = 'green') + xlab('Número de Clusters') + ylab('Índice de Silueta')
CH_plot+S_plot
track_part_final <- track_part %>% filter(genres %!in% c("house"))
#GUARDO LA PARTICION FINAL
save(track_part_final, file = "track_part_final.RData")
den1 <- ggplot(track_part_final) + geom_density(aes(loudness), color = 'green') + geom_density(aes(speechiness), color = 'orange') + geom_density(aes(liveness), color = 'purple') + geom_density(aes(tempo), color = 'darkslateblue') + xlab('feature')
den2 <- ggplot(track_part_final) + geom_density(aes(instrumentalness), color = 'cyan') + geom_density(aes(valence), color = 'chocolate') + geom_density(aes(acousticness),color = 'pink') + geom_density(aes(danceability), color = 'darkmagenta') + geom_density(aes(energy), color = 'red') + xlab('feature')
den1+den2
track_part_final <- track_part %>% filter(genres %!in% c("house"))
#GUARDO LA PARTICION FINAL
save(track_part_final, file = "track_part_final.RData")
den1 <- ggplot(track_part_final) + geom_density(aes(loudness), color = 'green') + geom_density(aes(speechiness), color = 'orange') + geom_density(aes(liveness), color = 'purple') + geom_density(aes(tempo), color = 'darkslateblue') + xlab('feature') + theme_bw()
den2 <- ggplot(track_part_final) + geom_density(aes(instrumentalness), color = 'cyan') + geom_density(aes(valence), color = 'chocolate') + geom_density(aes(acousticness),color = 'pink') + geom_density(aes(danceability), color = 'darkmagenta') + geom_density(aes(energy), color = 'red') + xlab('feature') + theme_bw()
den1+den2
S_plot <- ggplot(S_graph) + geom_point(mapping = aes(Number_Clusters,K.means),color = 'darkblue',size = 3) + geom_line(aes(Number_Clusters,K.means),color = 'cyan') +
geom_point(mapping = aes(Number_Clusters,Single),color = 'darkred',size = 3) + geom_line(aes(Number_Clusters,Single),color = 'red') +
geom_point(mapping = aes(Number_Clusters,Complete),color = 'darkgreen',size = 3) + geom_line(aes(Number_Clusters,Complete),color = 'green') + xlab('Número de Clusters') + ylab('Índice de Silueta') +
theme_bw() + geom_legend()
S_plot <- ggplot(S_graph) + geom_point(mapping = aes(Number_Clusters,K.means),color = 'darkblue',size = 3) + geom_line(aes(Number_Clusters,K.means),color = 'cyan') +
geom_point(mapping = aes(Number_Clusters,Single),color = 'darkred',size = 3) + geom_line(aes(Number_Clusters,Single),color = 'red') +
geom_point(mapping = aes(Number_Clusters,Complete),color = 'darkgreen',size = 3) + geom_line(aes(Number_Clusters,Complete),color = 'green',label = 'Complete') + xlab('Número de Clusters') + ylab('Índice de Silueta') +
theme_bw()
CH_plot+S_plot
CH_plot <- ggplot(CH_graph) + geom_point(mapping = aes(Number_Clusters,K.means),color = 'darkblue',size = 3) + geom_line(aes(Number_Clusters,K.means),color = 'cyan') +
geom_point(mapping = aes(Number_Clusters,Single),color = 'darkred',size = 3) + geom_line(aes(Number_Clusters,Single),color = 'red') +
geom_point(mapping = aes(Number_Clusters,Complete),color = 'darkgreen',size = 3) + geom_line(aes(Number_Clusters,Complete),color = 'green') + xlab('Número de Clusters') + ylab('Índice CH') + theme_bw()
S_plot <- ggplot(S_graph,aes(color = Method)) + geom_point(mapping = aes(Number_Clusters,K.means,color = K.means),color = 'darkblue',size = 3) + geom_line(aes(Number_Clusters,K.means),color = 'cyan') +
geom_point(mapping = aes(Number_Clusters,Single),color = 'darkred',size = 3) + geom_line(aes(Number_Clusters,Single),color = 'red') +
geom_point(mapping = aes(Number_Clusters,Complete),color = 'darkgreen',size = 3) + geom_line(aes(Number_Clusters,Complete),color = 'green') + xlab('Número de Clusters') + ylab('Índice de Silueta') +
theme_bw()
CH_plot+S_plot
# Ahora el plot anterior para que quede más claro con las etiquetas
mayores <-
ggplot(tracks_genre_features %>%
distinct(track.id, key, mode) %>%
filter(mode == 1),
aes(as.factor(key))) +
geom_bar(position = "dodge", fill = "darkgreen") +
labs(x = "Key", fill = "Mode") +
# hay más paletas aquí https://r-graph-gallery.com/38-rcolorbrewers-palettes.html
scale_x_discrete(labels = c("Do M",
"Reb M\n(5b)",
"Re M\n(2#)",
"Mib M\n(3b)",
"Mi M\n(4#)",
"Fa M\n(1b)",
"Fa# M/Solb M\n(6#/6b)",
"Sol M\n(1#)",
"Lab M\n(4b)",
"La M\n(3#)",
"Sib M\n(2b)",
"Si M\n(5#)")) +
theme_bw()
# Ahora el plot anterior para que quede más claro con las etiquetas
mayores <-
ggplot(tracks_genre_features %>%
distinct(track.id, key, mode) %>%
filter(mode == 1),
aes(as.factor(key))) +
geom_bar(position = "dodge", fill = "darkgreen") +
labs(x = "Key", fill = "Mode") +
# hay más paletas aquí https://r-graph-gallery.com/38-rcolorbrewers-palettes.html
scale_x_discrete(labels = c("Do M",
"Reb M\n(5b)",
"Re M\n(2#)",
"Mib M\n(3b)",
"Mi M\n(4#)",
"Fa M\n(1b)",
"Fa# M/Solb M\n(6#/6b)",
"Sol M\n(1#)",
"Lab M\n(4b)",
"La M\n(3#)",
"Sib M\n(2b)",
"Si M\n(5#)")) +
theme_bw()
menores <-
ggplot(tracks_genre_features %>%
distinct(track.id, key, mode) %>%
filter(mode == 0),
aes(as.factor(key))) +
geom_bar(position = "dodge", fill = "orange") +
labs(x = "Key", fill = "Mode") +
# hay más paletas aquí https://r-graph-gallery.com/38-rcolorbrewers-palettes.html
scale_x_discrete(labels = c("Do m\n(3b)",
"Do# m\n(4#)",
"Re m\n(1b)",
"Re# m/Mib m\n(6#/6b)",
"Mi m\n(1#)",
"Fa m\n(4b)",
"Fa# m\n(3#)",
"Sol m\n(2b)",
"Sol# m\n(5#)",
"La m",
"Sib m\n(5b)",
"Si m\n(2#)")) +
theme_bw()
mayores + menores
# para hacer scatterplots: energy and valence
ggplot(tracks_genre_features %>%
distinct(track.id, energy, valence), aes(energy, valence)) +
geom_point() +
theme_bw()
# coloreando con otra variable
ggplot(tracks_genre_features %>%
distinct(track.id, energy, valence, mode),
aes(energy, valence, color = as.factor(mode))) +
geom_point() +
theme_bw()
# distribuciones
ggplot(track_features, aes(danceability,
group = factor(genres),
color = factor(genres))) +
geom_boxplot() +
theme_bw()
# densidades
ggplot(tracks_genre_features, aes(energy,
group = factor(mode),
color = factor(mode))) +
geom_density() +
theme_bw()
# Gráfico de barras para ver de cada género cuantas hay
ggplot(analysis_alldata, aes(genres)) +
geom_bar() + # una barra contando cuantos hay de cada género
geom_text(stat='count', aes(label=..count..), vjust=-0.5) + # poner num
theme_bw() # quitar el fondo gris
analysis_alldata %>% nrow() # 742 filas
S_plot <- ggplot(S_graph) + geom_point(mapping = aes(Number_Clusters,K.means, color = K.means),color = 'darkblue',size = 3) + geom_line(aes(Number_Clusters,K.means),color = 'cyan') +
geom_point(mapping = aes(Number_Clusters,Single, color = Single),color = 'darkred',size = 3) + geom_line(aes(Number_Clusters,Single),color = 'red') +
geom_point(mapping = aes(Number_Clusters,Complete),color = 'darkgreen',size = 3) + geom_line(aes(Number_Clusters,Complete),color = 'green') + xlab('Número de Clusters') + ylab('Índice de Silueta') +
theme_bw()
CH_plot+S_plot
CH_plot+S_plot
